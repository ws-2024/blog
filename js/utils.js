HTMLElement.prototype.wrap=function(e){this.parentNode.insertBefore(e,this);this.parentNode.removeChild(this);e.appendChild(this)};(function(){const e=()=>document.dispatchEvent(new Event("page:loaded",{bubbles:true}));if(document.readyState==="loading"){document.addEventListener("readystatechange",e,{once:true})}else{e()}document.addEventListener("pjax:success",e)})();NexT.utils={registerExtURL(){document.querySelectorAll("span.exturl").forEach(e=>{const t=document.createElement("a");t.href=decodeURIComponent(atob(e.dataset.url).split("").map(e=>{return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));t.rel="noopener external nofollow noreferrer";t.target="_blank";t.className=e.className;t.title=e.title;t.innerHTML=e.innerHTML;e.parentNode.replaceChild(t,e)})},registerCopyButton(e,o,i=""){e.insertAdjacentHTML("beforeend",'<div class="copy-btn"><i class="fa fa-copy fa-fw"></i></div>');const r=e.querySelector(".copy-btn");r.addEventListener("click",()=>{if(!i){const e=o.querySelector(".code")||o.querySelector("code");i=e.innerText}if(navigator.clipboard){navigator.clipboard.writeText(i).then(()=>{r.querySelector("i").className="fa fa-check-circle fa-fw"},()=>{r.querySelector("i").className="fa fa-times-circle fa-fw"})}else{const t=document.createElement("textarea");t.style.top=window.scrollY+"px";t.style.position="absolute";t.style.opacity="0";t.readOnly=true;t.value=i;document.body.append(t);t.select();t.setSelectionRange(0,i.length);t.readOnly=false;const n=document.execCommand("copy");r.querySelector("i").className=n?"fa fa-check-circle fa-fw":"fa fa-times-circle fa-fw";t.blur();r.blur();document.body.removeChild(t)}});o.addEventListener("mouseleave",()=>{setTimeout(()=>{r.querySelector("i").className="fa fa-copy fa-fw"},300)})},registerCodeblock(e){const r=!!e;let t;if(CONFIG.hljswrap){t=(r?e:document).querySelectorAll("figure.highlight")}else{t=document.querySelectorAll("pre")}t.forEach(t=>{if(t.querySelector(".mermaid"))return;if(!r){let e=t.querySelectorAll(".code .line span");if(e.length===0){e=t.querySelectorAll("code.highlight span")}e.forEach(t=>{t.classList.forEach(e=>{t.classList.replace(e,`hljs-${e}`)})})}const e=parseInt(window.getComputedStyle(t).height,10);const n=CONFIG.fold.enable&&e>CONFIG.fold.height;if(!n&&!CONFIG.copycode.enable)return;let o;if(CONFIG.hljswrap&&CONFIG.copycode.style==="mac"){o=t}else{let e=t.querySelector(".code-container");if(!e){const i=t.querySelector(".table-container")||t;e=document.createElement("div");e.className="code-container";i.wrap(e);e.classList.add("notranslate")}o=e}if(n&&!o.classList.contains("unfold")){o.classList.add("highlight-fold");o.insertAdjacentHTML("beforeend",'<div class="fold-cover"></div><div class="expand-btn"><i class="fa fa-angle-down fa-fw"></i></div>');o.querySelector(".expand-btn").addEventListener("click",()=>{o.classList.remove("highlight-fold");o.classList.add("unfold")})}if(!r&&CONFIG.copycode.enable){this.registerCopyButton(o,t)}})},wrapTableWithBox(){document.querySelectorAll("table").forEach(e=>{const t=document.createElement("div");t.className="table-container";e.wrap(t)})},registerVideoIframe(){document.querySelectorAll("iframe").forEach(t=>{const e=["www.youtube.com","player.vimeo.com","player.youku.com","player.bilibili.com","www.tudou.com"].some(e=>t.src.includes(e));if(e&&!t.parentNode.matches(".video-container")){const n=document.createElement("div");n.className="video-container";t.wrap(n);const o=Number(t.width);const i=Number(t.height);if(o&&i){n.style.paddingTop=i/o*100+"%"}}})},updateActiveNav(){if(!Array.isArray(this.sections))return;let e=this.sections.findIndex(e=>{return e&&e.getBoundingClientRect().top>10});if(e===-1){e=this.sections.length-1}else if(e>0){e--}this.activateNavByIndex(e)},registerScrollPercent(){const n=document.querySelector(".back-to-top");const o=document.querySelector(".reading-progress-bar");window.addEventListener("scroll",()=>{if(n||o){const e=document.body.scrollHeight-window.innerHeight;const t=e>0?Math.min(100*window.scrollY/e,100):0;if(n){n.classList.toggle("back-to-top-on",Math.round(t)>=5);n.querySelector("span").innerText=Math.round(t)+"%"}if(o){o.style.setProperty("--progress",t.toFixed(2)+"%")}}this.updateActiveNav()},{passive:true});n&&n.addEventListener("click",()=>{window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:0})})},registerTabsTag(){document.querySelectorAll(".tabs ul.nav-tabs .tab").forEach(u=>{u.addEventListener("click",e=>{e.preventDefault();if(u.classList.contains("active"))return;const t=u.parentNode;const n=t.nextElementSibling;n.style.overflow="hidden";n.style.transition="height 1s";const o=n.querySelector(".active")||n.firstElementChild;const i=parseInt(window.getComputedStyle(o).height,10)||0;const r=parseInt(window.getComputedStyle(o).paddingTop,10);const c=parseInt(window.getComputedStyle(o.firstElementChild).marginBottom,10);n.style.height=i+r+c+"px";[...t.children].forEach(e=>{e.classList.toggle("active",e===u)});const s=document.getElementById(u.querySelector("a").getAttribute("href").replace("#",""));[...s.parentNode.children].forEach(e=>{e.classList.toggle("active",e===s)});s.dispatchEvent(new Event("tabs:click",{bubbles:true}));const a=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight);const l=parseInt(window.getComputedStyle(n.querySelector(".active")).height,10);n.style.height=l+r+c+"px";setTimeout(()=>{if(document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)!==a){n.style.transition="height 0.3s linear";const e=parseInt(window.getComputedStyle(n.querySelector(".active")).height,10);n.style.height=e+r+c+"px"}setTimeout(()=>{n.style.transition="";n.style.height=""},250)},1e3);if(!CONFIG.stickytabs)return;const d=t.parentNode.getBoundingClientRect().top+window.scrollY+10;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:d})})});window.dispatchEvent(new Event("tabs:register"))},registerCanIUseTag(){window.addEventListener("message",({data:e})=>{if(typeof e==="string"&&e.includes("ciu_embed")){const t=e.split(":")[1];const n=e.split(":")[2];document.querySelector(`iframe[data-feature=${t}]`).style.height=parseInt(n,10)+5+"px"}},false)},registerActiveMenuItem(){document.querySelectorAll(".menu-item a[href]").forEach(e=>{const t=e.pathname===location.pathname||e.pathname===location.pathname.replace("index.html","");const n=!CONFIG.root.startsWith(e.pathname)&&location.pathname.startsWith(e.pathname);e.classList.toggle("menu-item-active",e.hostname===location.hostname&&(t||n))})},registerLangSelect(){const e=document.querySelectorAll(".lang-select");e.forEach(e=>{e.value=CONFIG.page.lang;e.addEventListener("change",()=>{const t=e.options[e.selectedIndex];document.querySelectorAll(".lang-select-label span").forEach(e=>{e.innerText=t.text});window.location.href=t.dataset.href})})},registerSidebarTOC(){this.sections=[...document.querySelectorAll(".post-toc:not(.placeholder-toc) li a.nav-link")].map(n=>{const o=document.getElementById(decodeURI(n.getAttribute("href")).replace("#",""));n.addEventListener("click",e=>{e.preventDefault();const t=o.getBoundingClientRect().top+window.scrollY;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:t,complete:()=>{history.pushState(null,document.title,n.href)}})});return o});this.updateActiveNav()},registerPostReward(){const e=document.querySelector(".reward-container button");if(!e)return;e.addEventListener("click",()=>{document.querySelector(".post-reward").classList.toggle("active")})},activateNavByIndex(e){const t=document.querySelector(".post-toc:not(.placeholder-toc) .nav");if(!t)return;const n=t.querySelectorAll(".nav-item");const o=n[e];if(!o||o.classList.contains("active-current"))return;const i=n[n.length-1].offsetHeight;t.querySelectorAll(".active").forEach(e=>{e.classList.remove("active","active-current")});o.classList.add("active","active-current");let r=o.querySelector(".nav-child")||o.parentElement;let c=0;while(t.contains(r)){if(r.classList.contains("nav-item")){r.classList.add("active")}else{c+=i*r.childElementCount+5;r.style.setProperty("--height",`${c}px`)}r=r.parentElement}const s=document.querySelector(CONFIG.scheme==="Pisces"||CONFIG.scheme==="Gemini"?".sidebar-panel-container":".sidebar");if(!document.querySelector(".sidebar-toc-active"))return;window.anime({targets:s,duration:200,easing:"linear",scrollTop:s.scrollTop-s.offsetHeight/2+o.getBoundingClientRect().top-s.getBoundingClientRect().top})},updateSidebarPosition(){if(window.innerWidth<1200||CONFIG.scheme==="Pisces"||CONFIG.scheme==="Gemini")return;const e=document.querySelector(".post-toc:not(.placeholder-toc)");let t=CONFIG.page.sidebar;if(typeof t!=="boolean"){t=CONFIG.sidebar.display==="always"||CONFIG.sidebar.display==="post"&&e}if(t){window.dispatchEvent(new Event("sidebar:show"))}},activateSidebarPanel(e){const t=document.querySelector(".sidebar-inner");const n=["sidebar-toc-active","sidebar-overview-active"];if(t.classList.contains(n[e]))return;const o=t.querySelector(".sidebar-panel-container");const i=o.firstElementChild;const r=o.lastElementChild;let c=i.scrollHeight;if(e===0){const a=i.querySelector(".nav");if(a){c=parseInt(a.style.getPropertyValue("--height"),10)}}const s=[c,r.scrollHeight];o.style.setProperty("--inactive-panel-height",`${s[1-e]}px`);o.style.setProperty("--active-panel-height",`${s[e]}px`);t.classList.replace(n[1-e],n[e])},updateFooterPosition(){if(CONFIG.scheme==="Pisces"||CONFIG.scheme==="Gemini")return;function e(){const e=document.querySelector(".footer");const t=document.querySelector(".main").offsetHeight+e.offsetHeight;e.classList.toggle("footer-fixed",t<=window.innerHeight)}e();window.addEventListener("resize",e);window.addEventListener("scroll",e,{passive:true})},getScript(r,e={},t){if(typeof e==="function"){return this.getScript(r,{condition:t}).then(e)}const{condition:c=false,attributes:{id:s="",async:a=false,defer:l=false,crossOrigin:d="",dataset:u={},...m}={},parentNode:h=null}=e;return new Promise((e,t)=>{if(c){e()}else{const n=document.createElement("script");if(s)n.id=s;if(d)n.crossOrigin=d;n.async=a;n.defer=l;Object.assign(n.dataset,u);Object.entries(m).forEach(([e,t])=>{n.setAttribute(e,String(t))});n.onload=e;n.onerror=t;if(typeof r==="object"){const{url:o,integrity:i}=r;n.src=o;if(i){n.integrity=i;n.crossOrigin="anonymous"}}else{n.src=r}(h||document.head).appendChild(n)}})},loadComments(n,e){if(e){return this.loadComments(n).then(e)}return new Promise(o=>{const e=document.querySelector(n);if(!CONFIG.comments.lazyload||!e){o();return}const t=new IntersectionObserver((e,t)=>{const n=e[0];if(!n.isIntersecting)return;o();t.disconnect()});t.observe(e)})},debounce(n,o){let i;return function(...e){const t=this;clearTimeout(i);i=setTimeout(()=>n.apply(t,e),o)}}};